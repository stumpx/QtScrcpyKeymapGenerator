(this["webpackJsonpqtscrcpy-keymap-generator"]=this["webpackJsonpqtscrcpy-keymap-generator"]||[]).push([[0],{23:function(e,t,a){},24:function(e,t,a){},35:function(e,t,a){"use strict";a.r(t);var s=a(3),o=a.n(s),n=a(10),i=a.n(n),l=(a(23),a(4)),c=a(5),d=a(2),h=a(7),r=a(6),p=(a(24),a(15)),u=a.n(p),b=a(16),j=a(37),y=a(0),v=function(e){Object(h.a)(a,e);var t=Object(r.a)(a);function a(e){var s;return Object(l.a)(this,a),(s=t.call(this,e))._isMounted=!1,s.handleDrag=function(e,t){if(s._isMounted){var a=t.x/s.state.width*1,o=t.y/s.state.height*1,n={x:a=parseFloat(a.toFixed(6)),y:o=parseFloat(o.toFixed(6))};if(s.setState({pos:n,x:t.x,y:t.y}),s.props.setMouseMoveMap&&"MouseMap"===s.props.name){var i={startPos:{x:a,y:o}};s.props.setMouseMoveMap(i)}if(s.props.setMouseMoveMap&&"Key_Alt"===s.props.name){var l={smallEyes:{comment:"\u5c0f\u773c\u775b",type:"KMT_CLICK",key:"Key_Alt",pos:{x:a,y:o},switchMap:!1}};s.props.setMouseMoveMap(l)}}},s.state={count:0,index:e.index,name:e.name,x:e.x,y:e.y,pos:e.pos,height:e.height,width:e.width},s.handleStop=s.handleStop.bind(Object(d.a)(s)),s.start=s.start.bind(Object(d.a)(s)),s.setMouseMoveMap=s.setMouseMoveMap.bind(Object(d.a)(s)),s}return Object(c.a)(a,[{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.setState=function(e,t){}}},{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"handleStop",value:function(e,t){console.log("Key.handleStop",e,t),console.log(t)}},{key:"hover",value:function(){this.setState({hover:!0})}},{key:"leave",value:function(){this.setState({hover:!1})}},{key:"start",value:function(e){var t=this.state.count;t>1?console.log(e):(t+=.1,console.log(t),this.setState({count:t}))}},{key:"setMouseMoveMap",value:function(e){this.props.setMouseMoveMap(e)}},{key:"render",value:function(){return Object(y.jsx)(u.a,{onStol:this.props.parentCallback,onDrag:this.handleDrag,defaultPosition:{x:this.state.x,y:this.state.y},children:Object(y.jsx)("div",{"data-index":this.props.index,"data-x":this.state.x,"data-y":this.state.y,className:"key-map "+this.props.className,onDoubleClick:this.props.onDoubleClick,children:Object(y.jsx)("span",{children:this.state.name.replace("KMT_","").replace("Key_","")})})})}}]),a}(o.a.Component),M=function(e){Object(h.a)(a,e);var t=Object(r.a)(a);function a(e){var s;return Object(l.a)(this,a),(s=t.call(this,e)).handleDrag=function(e,t){var a=t.x/s.state.width*1,o=t.y/s.state.height*1;s.setState({pos:{x:a,y:o}})},s.state={data:e.data,height:e.height,width:e.width},s.setMouseMoveMap=s.setMouseMoveMap.bind(Object(d.a)(s)),s}return Object(c.a)(a,[{key:"componentWillUnmount",value:function(){this.setState=function(e,t){}}},{key:"setMouseMoveMap",value:function(e){this.props.setMouseMoveMap(e)}},{key:"render",value:function(){var e=this.state.width,t=this.state.height,a=this.state.data.startPos.x*e,s=this.state.data.startPos.y*t,o=this.state.data.smallEyes.pos.x*e,n=this.state.data.smallEyes.pos.y*t;return Object(y.jsxs)("div",{children:[Object(y.jsx)(v,{setMouseMoveMap:this.setMouseMoveMap,name:"MouseMap",pos:this.state.data.startPos,x:a,y:s,width:e,height:t}),Object(y.jsx)(v,{setMouseMoveMap:this.setMouseMoveMap,name:this.state.data.smallEyes.key,pos:this.state.data.smallEyes.pos,x:o,y:n,width:e,height:t})]})}}]),a}(o.a.Component);var m=function(e){Object(h.a)(a,e);var t=Object(r.a)(a);function a(e){var s;return Object(l.a)(this,a),(s=t.call(this,e)).onClickDownload=s.onClickDownload.bind(Object(d.a)(s)),s}return Object(c.a)(a,[{key:"componentWillUnmount",value:function(){this.setState=function(e,t){}}},{key:"onClickDownload",value:function(e){!function(e,t,a){var s=JSON.stringify(e,void 0,2),o=null;"blob"===t?o=new window.Blob([s],{type:"text/plain;charset=utf-8"}):"json"===t?o=new window.Blob([s],{type:"application/json"}):"markdown"===t&&(o=new window.Blob([s],{type:"text/markdown"}));var n=window.URL.createObjectURL(o),i=document.createElement("a");i.href=n,i.download=a,i.click(),URL.revokeObjectURL(n)}(JSON.parse(this.props.data),"json","\u952e\u76d8\u6620\u5c04.json")}},{key:"render",value:function(){var e=this.props.show?"modal display-block":"modal display-none";return Object(y.jsx)("div",{className:e,children:Object(y.jsxs)("section",{className:"modal-main",children:[Object(y.jsx)("p",{children:"\u7ed3\u679c\uff1a"}),Object(y.jsx)("br",{}),Object(y.jsx)("div",{className:"modal-body",children:Object(y.jsx)("textarea",{id:"result",name:"result",value:this.props.data,rows:20,cols:54})}),Object(y.jsx)("br",{}),Object(y.jsx)("button",{type:"button",onClick:this.props.handleClose,children:"\u5173\u95ed"}),Object(y.jsx)("button",{type:"button",onClick:this.onClickDownload,children:"\u4fdd\u5b58\u5230\u672c\u5730"})]})})}}]),a}(o.a.Component),O=function(e){Object(h.a)(a,e);var t=Object(r.a)(a);function a(e){var s;return Object(l.a)(this,a),console.log("ModalKey.props",e),(s=t.call(this,e)).state={keys:e.keys,data:e.data,index:e.index},s.saveChange=s.saveChange.bind(Object(d.a)(s)),s.updateParam=s.updateParam.bind(Object(d.a)(s)),s.deleteKey=s.deleteKey.bind(Object(d.a)(s)),s}return Object(c.a)(a,[{key:"componentWillUnmount",value:function(){this.setState=function(e,t){}}},{key:"componentDidMount",value:function(){var e=this;this.setState({data:this.props.data}),fetch("json-file/keys.json").then((function(e){return e.json()})).then((function(t){e.setState({keys:t})}))}},{key:"saveChange",value:function(){console.log("ModalKey.saveChange"),this.props.index&&this.props.parentUpdate&&this.props.parentUpdate(this.props.index,this.state.data)}},{key:"deleteKey",value:function(){console.log("ModalKey.deleteKey"),this.props.index&&this.props.parentRemove&&(this.props.parentRemove(this.props.index),this.props.handleClose())}},{key:"updateParam",value:function(e,t){console.log("ModalKey.updateParam",e,t);var a=this.props.data;a&&(a[e]=t,this.setState({data:a}))}},{key:"render",value:function(){var e=this,t=[];if(this.state.keys)for(var a=0;a<this.state.keys.length;a++){var s=this.state.keys[a];t.push(Object(y.jsx)("option",{children:s},"key-"+a))}var o=this.props.show?"modal display-block":"modal display-none";return Object(y.jsx)("div",{className:o,children:Object(y.jsxs)("section",{className:"modal-main",children:[Object(y.jsx)("p",{children:"\u6309\u952e\u8bbe\u7f6e"}),Object(y.jsx)("br",{}),Object(y.jsxs)("div",{className:"modal-body",children:[this.props.data?Object(y.jsxs)("div",{children:[Object(y.jsxs)("div",{children:[Object(y.jsx)("label",{htmlFor:"ModalKeyType",children:"\u7c7b\u578b\uff1a"}),Object(y.jsxs)("select",{name:"ModalKeyType",value:this.props.data.type,onChange:function(t){e.updateParam("type",t.target.value)},children:[Object(y.jsx)("option",{value:"KMT_CLICK",children:"KMT_CLICK"}),Object(y.jsx)("option",{value:"KMT_CLICK_TWICE",children:"KMT_CLICK_TWICE"}),Object(y.jsx)("option",{value:"KMT_CLICK_MULTI",children:"KMT_CLICK_MULTI"}),Object(y.jsx)("option",{value:"KMT_CLICK_MULTI",children:"KMT_DRAG"})]})]}),Object(y.jsx)("br",{}),Object(y.jsxs)("div",{children:[Object(y.jsx)("label",{htmlFor:"ModalOneKey",children:"\u6309\u952e\uff1a"}),Object(y.jsx)("select",{name:"ModalOneKey",value:this.props.data.key,onChange:function(t){e.updateParam("key",t.target.value)},children:t})]})]}):Object(y.jsx)("div",{}),Object(y.jsx)("br",{}),Object(y.jsx)("button",{type:"button",onClick:this.deleteKey,children:"\u5220\u9664"}),Object(y.jsx)("button",{type:"button",onClick:this.saveChange,children:"\u4fdd\u5b58"}),Object(y.jsx)("button",{type:"button",onClick:this.props.handleClose,children:"\u5173\u95ed"})]})]})})}}]),a}(o.a.Component),x=function(e){Object(h.a)(a,e);var t=Object(r.a)(a);function a(e){var s;return Object(l.a)(this,a),(s=t.call(this,e)).showModal=function(){console.log("App.showModal"),s.updateJson(),s.setState({show:!0})},s.showModalKey=function(e){s.updateJson(),console.log("App.showModalKey",s.state.dataJson.keyMapNodes[e],e),s.setState({showSetting:!0,selectedKey:s.state.dataJson.keyMapNodes[e],index:e})},s.hideModal=function(){s.setState({show:!1})},s.hideModalKey=function(){s.setState({showSetting:!1})},s.selectedFileName=localStorage.getItem("selectedFileName")||"codm_k40.json",s.handleImg=function(e){e.target.files[0]&&(document.getElementById("image").src=URL.createObjectURL(e.target.files[0]))},s.handleJsonFile=function(e){var t=Object(d.a)(s);if(e.target.files[0]){var a=new FileReader;a.readAsText(e.target.files[0],"UTF-8"),a.onload=function(a){try{var s=a.target.result;console.log("fileString",s);var o=JSON.parse(s);t.setState({dataJson:o}),t.updateJson()}catch(e){alert("\u8bf7\u9009\u62e9Json\u6587\u4ef6")}}}},s.state={height:e.height,width:e.width,dataJson:e.dataJson,show:!1,showSetting:!1},s.updatePosKeyMapNodes=s.updatePosKeyMapNodes.bind(Object(d.a)(s)),s.updateCenterPosKeyMapNodes=s.updateCenterPosKeyMapNodes.bind(Object(d.a)(s)),s.showModal=s.showModal.bind(Object(d.a)(s)),s.hideModal=s.hideModal.bind(Object(d.a)(s)),s.hideModalKey=s.hideModalKey.bind(Object(d.a)(s)),s.updateData=s.updateData.bind(Object(d.a)(s)),s.removeData=s.removeData.bind(Object(d.a)(s)),s.addKey=s.addKey.bind(Object(d.a)(s)),s.updateJson=s.updateJson.bind(Object(d.a)(s)),s.selectTemplate=s.selectTemplate.bind(Object(d.a)(s)),s.setMouseMoveMap=s.setMouseMoveMap.bind(Object(d.a)(s)),s}return Object(c.a)(a,[{key:"updateJson",value:function(){for(var e=document.getElementsByClassName("key-map"),t=this.state.dataJson,a=0;a<e.length;a++){var s=e[a],o={x:s.dataset.x/this.state.width*1,y:s.dataset.y/this.state.height*1};t.keyMapNodes[s.dataset.index]&&(t.keyMapNodes[s.dataset.index].pos&&(t.keyMapNodes[s.dataset.index].pos=o),t.keyMapNodes[s.dataset.index].centerPos&&(t.keyMapNodes[s.dataset.index].centerPos=o))}this.setState({dataJson:t})}},{key:"updateData",value:function(e,t){var a=this.state.dataJson;a.keyMapNodes&&(a.keyMapNodes[e]=t,this.setState({dataJson:a}))}},{key:"removeData",value:function(e){var t=this.state.dataJson;if(t.keyMapNodes){var a=t.keyMapNodes;a.splice(e,1),t.keyMapNodes=a,this.setState({dataJson:t})}}},{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){var e=this;this.setState({height:document.getElementById("image").clientHeight,width:document.getElementById("image").clientWidth}),console.log("App.componentDidMount.selectedFileName",this.selectedFileName),fetch("json-file/"+this.selectedFileName).then((function(e){return e.json()})).then((function(t){e.setState({dataJson:t})}))}},{key:"selectTemplate",value:function(e){var t=this;console.log("App.selectTemplate.selectedFileName",e.target.value),localStorage.setItem("selectedFileName",e.target.value),fetch("json-file/"+e.target.value).then((function(e){return e.json()})).then((function(e){t.setState({dataJson:e})}))}},{key:"updatePosKeyMapNodes",value:function(e,t){}},{key:"updateCenterPosKeyMapNodes",value:function(e,t){}},{key:"addKey",value:function(){var e=this.state.dataJson;e.keyMapNodes&&e.keyMapNodes.push({comment:"New Key",type:"KMT_CLICK",key:"Key_W",pos:{x:.4,y:.1},switchMap:!1}),this.setState({dataJson:e})}},{key:"handleDraggable",value:function(e,t){console.log(t)}},{key:"syntaxHighlight",value:function(e){if("string"!=typeof e&&(e=JSON.stringify(e,void 0,2)),e)return(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,(function(e){var t="number";return/^"/.test(e)?t=/:$/.test(e)?"key":"string":/true|false/.test(e)?t="boolean":/null/.test(e)&&(t="null"),'<span class="'+t+'">'+e+"</span>"}))}},{key:"setMouseMoveMap",value:function(e){this.state.dataJson.mouseMoveMap=Object.assign(this.state.dataJson.mouseMoveMap,e)}},{key:"render",value:function(){var e=this,t=this.state.width,a=this.state.height,s=[];return this.state.dataJson&&(this.state.dataJson.mouseMoveMap&&s.push(Object(y.jsx)(M,{setMouseMoveMap:this.setMouseMoveMap,data:this.state.dataJson.mouseMoveMap,width:t,height:a},"mouse")),this.state.dataJson.keyMapNodes&&this.state.dataJson.keyMapNodes.map((function(o,n){if(o)if(o.pos){var i=o.pos.x*t,l=o.pos.y*a;s.push(Object(y.jsx)(v,{className:"node-".concat(n),onDoubleClick:e.showModalKey.bind(e,n),index:n,name:o.key,pos:o.pos,x:i,y:l,width:t,height:a,parentCallback:e.updatePosKeyMapNodes},Object(j.a)()))}else if(o.centerPos){var c=o.centerPos.x*t,d=o.centerPos.y*a;s.push(Object(y.jsx)(v,{className:"node-center-".concat(n),onDoubleClick:e.showModalKey.bind(e,n),index:n,name:o.key||o.type,pos:o.centerPos,x:c,y:d,width:t,height:a,parentCallback:e.updateCenterPosKeyMapNodes},Object(j.a)()))}}))),Object(y.jsxs)("div",{children:[Object(y.jsxs)(b.a,{children:[Object(y.jsx)("title",{children:"QTScrcpy Keymapper Generator"}),Object(y.jsx)("meta",{name:"description",content:"QTScrcpy Keymapper Generator"})]}),Object(y.jsx)("img",{src:"./codm_k40_001_20230404153007.jpg",id:"image"}),Object(y.jsx)("div",{className:"map",children:s}),Object(y.jsx)(m,{show:this.state.show,handleClose:this.hideModal,data:JSON.stringify(this.state.dataJson,void 0,4)}),Object(y.jsxs)("div",{className:"list-button",children:[Object(y.jsxs)("select",{onChange:this.selectTemplate,defaultValue:this.selectedFileName,children:[Object(y.jsx)("option",{value:"codm_k40.json",children:"\u6a21\u677fcodm_k40"}),Object(y.jsx)("option",{value:"pubg.json",children:"\u6a21\u677fpubg"}),Object(y.jsx)("option",{value:"genshin.json",children:"\u6a21\u677fgenshin"})]}),Object(y.jsx)("input",{id:"jsonFile",type:"file",placeholder:"Choose background",title:"choose background",onChange:this.handleJsonFile}),Object(y.jsx)("label",{htmlFor:"jsonFile",children:"\u9009\u62e9\u672c\u5730Json\u6587\u4ef6"}),Object(y.jsx)("input",{id:"bg",type:"file",placeholder:"Choose background",title:"choose background",onChange:this.handleImg}),Object(y.jsx)("label",{htmlFor:"bg",children:"\u9009\u62e9\u622a\u56fe"}),Object(y.jsx)("button",{type:"button",className:"button",onClick:this.showModal,children:"\u663e\u793a\u7ed3\u679c&\u4fdd\u5b58"}),Object(y.jsx)("button",{type:"button",className:"button",onClick:this.addKey,children:"\u589e\u52a0\u6309\u952e"})]}),Object(y.jsx)(O,{show:this.state.showSetting,handleClose:this.hideModalKey,data:this.state.selectedKey,index:this.state.index,parentUpdate:this.updateData,parentRemove:this.removeData})]})}}]),a}(o.a.Component),g=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,38)).then((function(t){var a=t.getCLS,s=t.getFID,o=t.getFCP,n=t.getLCP,i=t.getTTFB;a(e),s(e),o(e),n(e),i(e)}))};i.a.render(Object(y.jsx)(x,{}),document.getElementById("root")),g()}},[[35,1,2]]]);
//# sourceMappingURL=main.7e75e0f8.chunk.js.map